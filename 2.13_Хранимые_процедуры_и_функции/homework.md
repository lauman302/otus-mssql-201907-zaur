# SP и function

1. Написать функцию возвращающую Клиента с наибольшей суммой покупки.

2. Написать хранимую процедуру с входящим параметром СustomerID, выводящую сумму покупки по этому клиенту.
    Использовать таблицы :
    - Sales.Customers
    - Sales.Invoices
    - Sales.InvoiceLines

    ```
    2.13.1-2.sql
    ```

3. Создать одинаковую функцию и хранимую процедуру, посмотреть в чем разница в производительности и почему.

    ```
    2.13.1-2.sql
    ```

    Принципиальной разницы в скорости выполнения не замечено, планы выполнения одинаковые, статистики схожие.

4. Создайте табличную функцию покажите как ее можно вызвать для каждой строки result set'а без использования цикла.

    ```
    2.13.4.sql
    ```

    Также использована функция из предыдущего задания.

5. Во всех процедурах в описании укажите для преподавателя какой уровень изоляции нужен и почему.

Опционально:

6. Переписываем одну и ту же процедуру `kitchen sink` с множеством входных параметров по поиску в заказах на динамический SQL. Сравниваем планы запроса.

7. Напишите запрос в транзакции где есть выборка, вставка\добавление\удаление данных и параллельно запускаем выборку данных в разных уровнях изоляции, нужно предоставить мини отчет, что на каком уровне было видно со скриншотами и ваши выводы (1-2 предложение).

8. Сделайте параллельно в 2х окнах добавление данных в одну таблицу с разным уровнем изоляции, изменение данных в одной таблице, изменение одной и той же строки. Что в итоге получилось, что нового узнали.

Рекомендуем сдать до: 22.09.2019
